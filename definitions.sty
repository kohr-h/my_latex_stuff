\RequirePackage{thmtools}
\RequirePackage{xspace}
\RequirePackage{nicefrac}



% Spaces

\newcommand*{\W}{\ensuremath{\mathscr{W}}}
\newcommand*{\X}{\ensuremath{\mathscr{X}}}
\newcommand*{\Y}{\ensuremath{\mathscr{Y}}}
\newcommand*{\Z}{\ensuremath{\mathscr{Z}}}

\newcommand*{\dual}[1]{\ensuremath{#1^*}}

\newcommand*{\Wdual}{\dual{\W}}
\newcommand*{\Xdual}{\dual{\X}}
\newcommand*{\Ydual}{\dual{\Y}}
\newcommand*{\Zdual}{\dual{\Z}}

\newcommand*{\dpW}[2]{\ensuremath{\langle #1,\,#2\rangle}_{\W\times\Wdual}}
\newcommand*{\dpX}[2]{\ensuremath{\langle #1,\,#2\rangle}_{\X\times\Xdual}}
\newcommand*{\dpY}[2]{\ensuremath{\langle #1,\,#2\rangle}_{\Y\times\Ydual}}
\newcommand*{\dpZ}[2]{\ensuremath{\langle #1,\,#2\rangle}_{\Z\times\Zdual}}



% Operators

\newcommand*{\op}[1]{\ensuremath{\mathcal{#1}}}

\newcommand*{\Aop}{{\op{A}}}
\newcommand*{\Bop}{{\op{B}}}
\newcommand*{\Cop}{{\op{C}}}
\newcommand*{\Dop}{{\op{D}}}
\newcommand*{\Fop}{{\op{F}}}
\newcommand*{\Hop}{{\op{H}}}
\newcommand*{\Iop}{{\op{I}}}
\newcommand*{\Lop}{{\op{L}}}
\newcommand*{\Mop}{{\op{M}}}
\newcommand*{\Pop}{{\op{P}}}
\newcommand*{\Rop}{{\op{R}}}
\newcommand*{\Sop}{{\op{S}}}
\newcommand*{\Top}{{\op{T}}}
\newcommand*{\Uop}{{\op{U}}}
\newcommand*{\Xop}{{\op{X}}}

\newcommand*{\Adual}{{\dual{\Aop}}}
\newcommand*{\Bdual}{{\dual{\Bop}}}
\newcommand*{\Cdual}{{\dual{\Cop}}}
\newcommand*{\Ldual}{{\dual{\Lop}}}
\newcommand*{\Pdual}{{\dual{\Pop}}}
\newcommand*{\Rdual}{{\dual{\Rop}}}



% Bold vectors
\newcommand*{\bx}{{\boldsymbol{x}}}
\newcommand*{\bnull}{{\boldsymbol{0}}}
\newcommand*{\bone}{{\boldsymbol{1}}}
\newcommand*{\by}{{\boldsymbol{y}}}
\newcommand*{\bs}{{\boldsymbol{s}}}
\newcommand*{\bj}{{\boldsymbol{j}}}
\newcommand*{\bk}{{\boldsymbol{k}}}
\newcommand*{\bl}{{\boldsymbol{l}}}
\newcommand*{\bN}{{\boldsymbol{N}}}
\newcommand*{\bxi}{{\boldsymbol{\xi}}}
\newcommand*{\btheta}{{\boldsymbol{\theta}}}






% Other math stuff

\newcommand*{\abs}[1]{\ensuremath{|#1|}}
\newcommand*{\absbig}[1]{\ensuremath{\big| #1 \big|}}
\newcommand*{\abslr}[1]{\ensuremath{\left| #1 \right|}}
\newcommand*{\norm}[1]{\ensuremath{\Vert #1 \Vert}}
\newcommand*{\normbig}[1]{\ensuremath{\big\Vert #1 \big\Vert}}
\newcommand*{\normlr}[1]{\ensuremath{\left\Vert #1 \right\Vert}}
\newcommand*{\spr}[2]{\ensuremath{\langle #1,\,#2\rangle}}
\newcommand*{\sprbig}[2]{\ensuremath{\big\langle #1,\,#2\big\rangle}}
\newcommand*{\sprlr}[2]{\ensuremath{\left\langle #1,\,#2\right\rangle}}
\newcommand*{\inv}[1]{\ensuremath{\frac{1}{#1}}}
\newcommand*{\diff}[0]{\ensuremath{\mathrm{d}}}
\renewcommand*{\Re}[0]{\ensuremath{\mathrm{Re}}}
\renewcommand*{\Im}[0]{\ensuremath{\mathrm{Im}}}
\renewcommand*{\i}[0]{\ensuremath{i}}
\newcommand*{\tx}[0]{\ensuremath{\textstyle}}
\newcommand*{\longto}[0]{\ensuremath{\longrightarrow}}
\newcommand*{\Longto}[0]{\ensuremath{\Longrightarrow}}
\newcommand*{\Eq}[0]{\ensuremath{\Leftrightarrow}}
\newcommand*{\LEq}[0]{\ensuremath{\Longleftrightarrow}}
\newcommand*{\id}[0]{\ensuremath{\mathrm{id}}}
\newcommand*{\nfhalf}{{\ensuremath{\nicefrac{1}{2}}}}
\newcommand*{\Lapl}[0]{\ensuremath{\varDelta}}
\newcommand*{\Order}[0]{\ensuremath{\mathcal{O}}}
\newcommand*{\order}[0]{\ensuremath{o}}
\newcommand*{\pderiv}[2]{{\ensuremath{\frac{\partial #1}{\partial #2}}}}
\newcommand*{\eps}{{\ensuremath{\varepsilon}}}



\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\sign}{sign}
\DeclareMathOperator*{\sinc}{sinc}
\DeclareMathOperator*{\supp}{supp}

\DeclareMathOperator*{\CTF}{CTF}
\DeclareMathOperator*{\PSF}{PSF}


% Mollifiers and kernels

\newcommand*{\dxg}{\ensuremath{\delta_x^\gamma}}
\newcommand*{\dg}{\ensuremath{\delta^\gamma}}
\newcommand*{\pxg}{\ensuremath{\psi_x^\gamma}}
\newcommand*{\Pxg}{\ensuremath{\Psi_x^\gamma}}
\newcommand*{\pxBg}{\ensuremath{\psi_{\Bop,x}^{\gamma}}}
\newcommand*{\Lpxg}{\ensuremath{\psi_x^{\Lop,\gamma}}}
\newcommand*{\LpxBg}{\ensuremath{\psi_{\Bop,x}^{\Lop,\gamma}}}
\newcommand*{\pg}{\ensuremath{\psi^\gamma}}
\newcommand*{\Pg}{\ensuremath{\Psi^\gamma}}
\newcommand*{\pBg}{\ensuremath{\psi_{\Bop}^{\gamma}}}
\newcommand*{\Lpg}{\ensuremath{\psi^{\Lop,\gamma}}}
\newcommand*{\LpBg}{\ensuremath{\psi_{\Bop}^{\Lop,\gamma}}}


% AI operators

\newcommand*{\Ag}{\ensuremath{\Aop^\gamma}}
\newcommand*{\ABg}{\ensuremath{\Aop_{\Bop}^{\gamma}}}
\newcommand*{\LAg}{\ensuremath{\Aop^{\Lop,\gamma}}}
\newcommand*{\LABg}{\ensuremath{\Aop_{\Bop}^{\Lop,\gamma}}}

\newcommand*{\Tx}{\ensuremath{\Top_x^{(0)}}}
\newcommand*{\Txi}{\ensuremath{\Top_x^{(1)}}}
\newcommand*{\Txii}{\ensuremath{\Top_x^{(2)}}}
\newcommand*{\Txiii}{\ensuremath{\Top_x^{(3)}}}


% General and special sets

\newcommand*{\setbig}[2]{\ensuremath{\big\{#1\,\big|\,#2\big\}}}
\newcommand*{\setlr}[2]{\ensuremath{\left\{#1\,\right|\left.\,#2\right\}}}
\DeclareMathOperator{\Span}{span}

\newcommand*{\NN}[0]{{\ensuremath{\mathbb{N}}}}
\newcommand*{\ZZ}[0]{{\ensuremath{\mathbb{Z}}}}
\newcommand*{\RR}[0]{{\ensuremath{\mathbb{R}}}}
\newcommand*{\CC}[0]{{\ensuremath{\mathbb{C}}}}

\newcommand*{\Domain}{\ensuremath{\mathscr{D}}}
\newcommand*{\Range}{\ensuremath{\mathscr{R}}}
\newcommand*{\Null}{\ensuremath{\mathscr{N}}}
\newcommand*{\Sphere}{\ensuremath{\mathscr{S}}}
\newcommand*{\Circle}{\ensuremath{\mathscr{C}}}
\newcommand*{\Schwartz}{\ensuremath{S}}
\newcommand*{\HalfSpace}{\ensuremath{\mathscr{H}}}
\newcommand*{\TanBundle}{\ensuremath{\mathscr{T}}}
\newcommand*{\Grid}{\ensuremath{\mathscr{G}}}

\newcommand*{\BoundedOp}{\ensuremath{\ell}}
\newcommand*{\DdefinedOp}{\ensuremath{d}}
\newcommand*{\ClosableOp}{\ensuremath{c}}
\newcommand*{\ClosedOp}{\ensuremath{C}}


% Other non-math stuff

%%%% Common abbreviations.
\newcommand{\eg}{\textsl{e.g.}\xspace}
\newcommand{\ie}{\textsl{i.e.}\xspace}
\newcommand{\wrt}{w.r.t.\xspace}
\newcommand{\etc}{\textsl{etc.}\xspace}
\newcommand{\viz}{\textsl{viz.}\xspace}


\newlength{\imwdhalf}
\setlength{\imwdhalf}{0.45\linewidth}
\newlength{\imspc}
\setlength{\imspc}{0.03\linewidth}

\newcommand{\note}[2][\null]{%
  \marginpar{\renewcommand{\baselinestretch}{1}\vspace{-1em}\hrule\vspace{3pt}%
  \scriptsize\raggedright\textsf{#2\ifx#1\null\else\\\hfill---
  {\em #1}\fi}\vspace{1.5em}}%
}

%---------------------------------------------------


% theorem styles and definitions

\declaretheoremstyle[%
 spaceabove = 3ex,%
 spacebelow = 3ex,%
 headfont = \normalfont\bfseries,%
 headpunct = . ,%
 headformat = swapnumber,%
 notefont = \bfseries,%
 notebraces = {(}{)},%
 bodyfont = \itshape,%
 postheadspace = 1em %
]{thmstyle}

\declaretheorem[style=thmstyle, parent=section, name=Theorem]{theorem}
\declaretheorem[style=thmstyle, numbered=no, name=Theorem]{theorem*}
\declaretheorem[style=thmstyle, sharenumber=theorem, name=Lemma]{lemma}
\declaretheorem[style=thmstyle, sharenumber=theorem, name=Corollary]{corollary}

\declaretheoremstyle[%
 spaceabove = 3ex,%
 spacebelow = 3ex,%
 headfont = \normalfont\bfseries,%
 headpunct = . ,%
 headformat = swapnumber,%
 notefont = \bfseries,%
 notebraces = {(}{)},%
 bodyfont = \itshape,%
 postheadspace = 1em,%
 qed = \textsquare
]{algorithmstyle}

\declaretheorem[style=algorithmstyle, sharenumber=theorem, name=Algorithm]{algorithm}

\declaretheoremstyle[%
 spaceabove = 3ex,%
 spacebelow = 3ex,%
 headfont = \normalfont\bfseries,%
 headpunct = . ,%
 headformat = swapnumber,%
 notefont = \bfseries,%
 notebraces = {(}{)},%
 bodyfont = \itshape,%
 postheadspace = 1em%
]{definitionstyle}

\declaretheorem[style=definitionstyle, sharenumber=theorem, name=Definition]{definition}
\declaretheorem[style=definitionstyle, sharenumber=theorem, name=Example]{example}

\declaretheoremstyle[%
 spaceabove = 3ex,%
 spacebelow = 3ex,%
 headfont = \normalfont\bfseries,%
 headpunct = . ,%
 notefont = \mdseries,%
 notebraces = {(}{)},%
 bodyfont = \upshape,%
 postheadspace = 1em,%
 qed = \textsquare%
]{remarkstyle}

\declaretheorem[style=remarkstyle, numbered=no, name=Remark]{remark}

\declaretheoremstyle[%
 spaceabove = 3ex,%
 spacebelow = 3ex,%
 headfont = \normalfont\bfseries,%
 headpunct = . ,%
 notefont = \mdseries,%
 notebraces = {(}{)},%
 bodyfont = \upshape,%
 postheadspace = 0em%
]{remarksstyle}

\declaretheorem[style=remarksstyle, numbered=no, name=Remarks]{remarks}

\declaretheoremstyle[%
 spaceabove = 3ex,%
 spacebelow = 3ex,%
 headfont = \normalfont\bfseries,%
 headpunct = . ,%
 notefont = \mdseries,%
 notebraces = {(}{)},%
 bodyfont = \upshape,%
 postheadspace = 1em,%
 qed = \textsquare%
]{proofstyle}

\declaretheorem[style=proofstyle, numbered=no, name=Proof]{myproof}

